<!DOCTYPE html>
<html>
  <head>
    <link
      rel="stylesheet"
      href="../../zoomtestapp/videosdk-ui-toolkit/dist/videosdk-ui-toolkit.css"
    />
    <link 
      rel="stylesheet"
      href="../css/styles-video.css"
    />
    <script
      src="../../zoomtestapp/videosdk-ui-toolkit/index.js"
      type="module"
    ></script>
    <script src="../../zoomtestapp/script.js" type="module"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsrsasign/8.0.20/jsrsasign-all-min.js"></script>
    <title>Test Zoom UI</title>
  </head>
  <body>
    <!-- Main Container -->
    <div class="mainContainer">
      
      <!-- Friend Section -->
      <div class="friendSection">
        <div class="friend-ellipse"></div>
        <img
          src="../images/taskEllipse.png"
          class="ellipse1"
          alt="pink ellipse top-left"
        />
        <img
          src="../images/taskEllipse.png"
          class="ellipse2"
          alt="pink ellipse top-right"
        />
        <img
          src="../images/taskEllipse.png"
          class="ellipse3"
          alt="pink ellipse bottom-left"
        />
        <img
          src="../images/taskEllipse.png"
          class="ellipse4"
          alt="pink ellipse bottom-right"
        />
        <h2>friends</h2>
        <hr width="100%" size="2" />
        <ul class="friend-list" id="friendList">
          <!-- Friends will be loaded here dynamically -->
           <li>
            <div class="avatar-container">
              <div class="online-indicator"></div> <!-- Green dot for online status -->
            </div>
            </li>
        </ul>
      </div>
      
      <!-- Video Section -->
      <div class="videoSection">
        <!-- sessionContainer is needed to load in zoom call interface -->
        <div id="sessionContainer"></div>
      </div>

      <!-- Task Section -->
      <div class="taskSection">
        <div class="task-ellipse">
          <img
            src="../images/taskEllipse.png"
            class="ellipse5"
            alt="pink ellipse top-left"
          />
          <img
            src="../images/taskEllipse.png"
            class="ellipse6"
            alt="pink ellipse top-right"
          />
          <img
            src="../images/taskEllipse.png"
            class="ellipse7"
            alt="pink ellipse bottom-left"
          />
          <img
            src="../images/taskEllipse.png"
            class="ellipse8"
            alt="pink ellipse bottom-right"
          />
        </div>
        <h2>tasks</h2>
        <hr width="100%" size="2" />
        <ul id="task-list" class="checklist">
          <!-- Tasks will be added here dynamically -->
        </ul>
      </div>

    </div>
    <script>
      // Sample Friends and Tasks Data for Designing can remove
      const friends = [
        { username: "sean009", avatar: "../images/redpanda.png", online: true },
        { username: "michelle22", avatar: "../images/rabbit.png", online: true },
        { username: "trixtonstudys", avatar: "../images/dog.png", online: false},
        { username: "melanie68", avatar: "../images/koala.png", online: true},
        { username: "testuser1", avatar: "../images/koala.png", online: false},
        { username: "testuser2", avatar: "../images/koala.png", online: true },
        { username: "testuser3", avatar: "../images/koala.png", online: false}
      ];

      const tasks = [
        { id: 1, description: "Task 1" },
        { id: 2, description: "Task 2" },
        { id: 3, description: "Task 3" },
        { id: 4, description: "Task 4" },
        { id: 5, description: "Task 5" },
        { id: 6, description: "Task 6" },
        { id: 7, description: "Task 7" },
        { id: 8, description: "Task 8" },
        { id: 8, description: "Task 9" },
        { id: 8, description: "Task 10" },
        { id: 8, description: "Task 11" }
      ];

      function loadFriends() {
        const friendList = document.getElementById("friendList");
      
        friends.forEach(friend => {
          const listItem = document.createElement("li");
      
          const avatarContainer = document.createElement("div");
          avatarContainer.classList.add("avatar-container");
      
          const avatar = document.createElement("img");
          avatar.src = friend.avatar;
          avatar.alt = `${friend.username}'s avatar`;
      
          // Add green dot if the friend is online
          if (friend.online) {
            const onlineIndicator = document.createElement("div");
            onlineIndicator.classList.add("online-indicator");
            avatarContainer.appendChild(onlineIndicator);
          }
      
          avatarContainer.appendChild(avatar);
      
          const username = document.createElement("span");
          username.textContent = friend.username;
      
          listItem.appendChild(avatarContainer);
          listItem.appendChild(username);
          friendList.appendChild(listItem);
        });
      }

      // Function to delete a task and renumber the list
      function deleteTask(taskId, taskItem) {
        const taskList = document.getElementById("task-list");
        taskList.removeChild(taskItem); // Remove task
        renumberTasks(); // Renumber remaining tasks
      }

      // Function to renumber tasks after deletion or addition
      function renumberTasks() {
        const taskList = document.getElementById("task-list");
        const tasks = taskList.children;
        for (let i = 0; i < tasks.length; i++) {
          const taskLabel = tasks[i].querySelector("span");
          taskLabel.textContent = `${i + 1}. ${taskLabel.textContent.split(". ")[1]}`;
        }
      }

      // Function to load tasks into the task list
      function loadTasks() {
        const taskList = document.getElementById("task-list");

        tasks.forEach((task) => {
          const listItem = document.createElement("li");

          const taskDescription = document.createElement("span");
          taskDescription.textContent = `${task.id}. ${task.description}`;

          // Checkbox
          const taskCheckbox = document.createElement("input");
          taskCheckbox.type = "checkbox";
          taskCheckbox.classList.add("task-checkbox");
          taskCheckbox.addEventListener("change", function () {
            if (this.checked) {
              listItem.style.backgroundColor = "#88d698"; // Green on completion
              setTimeout(() => {
                deleteTask(task.id, listItem); // Delete after a short delay
              }, 500); // Adjust delay as needed
            }
          });

          listItem.appendChild(taskDescription);
          listItem.appendChild(taskCheckbox);
          taskList.appendChild(listItem);
        });
      }

      // Call the functions to load data on page load
      document.addEventListener("DOMContentLoaded", () => {
        loadFriends();
        loadTasks();
      });
    </script>
  
  </body>
</html>
